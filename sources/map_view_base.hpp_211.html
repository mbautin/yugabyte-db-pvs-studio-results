
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>map_view_base.hpp</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">// Boost.Bimap</a>
<a name="ln2">//</a>
<a name="ln3">// Copyright (c) 2006-2007 Matias Capeletto</a>
<a name="ln4">//</a>
<a name="ln5">// Distributed under the Boost Software License, Version 1.0.</a>
<a name="ln6">// (See accompanying file LICENSE_1_0.txt or copy at</a>
<a name="ln7">// http://www.boost.org/LICENSE_1_0.txt)</a>
<a name="ln8"> </a>
<a name="ln9">/// \file detail/map_view_base.hpp</a>
<a name="ln10">/// \brief Helper base for the construction of the bimap views types.</a>
<a name="ln11"> </a>
<a name="ln12">#ifndef BOOST_BIMAP_DETAIL_MAP_VIEW_BASE_HPP</a>
<a name="ln13">#define BOOST_BIMAP_DETAIL_MAP_VIEW_BASE_HPP</a>
<a name="ln14"> </a>
<a name="ln15">#if defined(_MSC_VER)</a>
<a name="ln16">#pragma once</a>
<a name="ln17">#endif</a>
<a name="ln18"> </a>
<a name="ln19">#include &lt;boost/config.hpp&gt;</a>
<a name="ln20"> </a>
<a name="ln21">#include &lt;stdexcept&gt;</a>
<a name="ln22">#include &lt;utility&gt;</a>
<a name="ln23"> </a>
<a name="ln24">#include &lt;boost/throw_exception.hpp&gt;</a>
<a name="ln25">#include &lt;boost/type_traits/is_const.hpp&gt;</a>
<a name="ln26">#include &lt;boost/mpl/if.hpp&gt;</a>
<a name="ln27"> </a>
<a name="ln28">#include &lt;boost/bimap/relation/support/get_pair_functor.hpp&gt;</a>
<a name="ln29">#include &lt;boost/bimap/relation/detail/to_mutable_relation_functor.hpp&gt;</a>
<a name="ln30">#include &lt;boost/bimap/container_adaptor/support/iterator_facade_converters.hpp&gt;</a>
<a name="ln31">#include &lt;boost/bimap/relation/support/data_extractor.hpp&gt;</a>
<a name="ln32">#include &lt;boost/bimap/relation/support/opposite_tag.hpp&gt;</a>
<a name="ln33">#include &lt;boost/bimap/relation/support/pair_type_by.hpp&gt;</a>
<a name="ln34">//#include &lt;boost/bimap/support/iterator_type_by.hpp&gt;</a>
<a name="ln35">#include &lt;boost/bimap/support/key_type_by.hpp&gt;</a>
<a name="ln36">#include &lt;boost/bimap/support/data_type_by.hpp&gt;</a>
<a name="ln37">#include &lt;boost/bimap/support/value_type_by.hpp&gt;</a>
<a name="ln38">#include &lt;boost/bimap/detail/modifier_adaptor.hpp&gt;</a>
<a name="ln39">#include &lt;boost/bimap/detail/debug/static_error.hpp&gt;</a>
<a name="ln40">#include &lt;boost/bimap/detail/map_view_iterator.hpp&gt;</a>
<a name="ln41"> </a>
<a name="ln42">namespace boost {</a>
<a name="ln43">namespace bimaps {</a>
<a name="ln44"> </a>
<a name="ln45">namespace detail {</a>
<a name="ln46"> </a>
<a name="ln47"> </a>
<a name="ln48">// The next macro can be converted in a metafunctor to gain code robustness.</a>
<a name="ln49">/*===========================================================================*/</a>
<a name="ln50">#define BOOST_BIMAP_MAP_VIEW_CONTAINER_ADAPTOR(                               \</a>
<a name="ln51">    CONTAINER_ADAPTOR, TAG, BIMAP, OTHER_ITER, CONST_OTHER_ITER               \</a>
<a name="ln52">)                                                                             \</a>
<a name="ln53">::boost::bimaps::container_adaptor::CONTAINER_ADAPTOR                         \</a>
<a name="ln54">&lt;                                                                             \</a>
<a name="ln55">    BOOST_DEDUCED_TYPENAME BIMAP::core_type::                                 \</a>
<a name="ln56">        BOOST_NESTED_TEMPLATE index&lt;TAG&gt;::type,                               \</a>
<a name="ln57">    ::boost::bimaps::detail::      map_view_iterator&lt;TAG,BIMAP&gt;,              \</a>
<a name="ln58">    ::boost::bimaps::detail::const_map_view_iterator&lt;TAG,BIMAP&gt;,              \</a>
<a name="ln59">    ::boost::bimaps::detail::      OTHER_ITER&lt;TAG,BIMAP&gt;,                     \</a>
<a name="ln60">    ::boost::bimaps::detail::CONST_OTHER_ITER&lt;TAG,BIMAP&gt;,                     \</a>
<a name="ln61">    ::boost::bimaps::container_adaptor::support::iterator_facade_to_base      \</a>
<a name="ln62">    &lt;                                                                         \</a>
<a name="ln63">        ::boost::bimaps::detail::      map_view_iterator&lt;TAG,BIMAP&gt;,          \</a>
<a name="ln64">        ::boost::bimaps::detail::const_map_view_iterator&lt;TAG,BIMAP&gt;           \</a>
<a name="ln65">    &gt;,                                                                        \</a>
<a name="ln66">    ::boost::mpl::na,                                                         \</a>
<a name="ln67">    ::boost::mpl::na,                                                         \</a>
<a name="ln68">    ::boost::bimaps::relation::detail::                                       \</a>
<a name="ln69">        pair_to_relation_functor&lt;TAG,BOOST_DEDUCED_TYPENAME BIMAP::relation&gt;, \</a>
<a name="ln70">    ::boost::bimaps::relation::support::                                      \</a>
<a name="ln71">        get_pair_functor&lt;TAG, BOOST_DEDUCED_TYPENAME BIMAP::relation &gt;        \</a>
<a name="ln72">&gt;</a>
<a name="ln73">/*===========================================================================*/</a>
<a name="ln74"> </a>
<a name="ln75"> </a>
<a name="ln76">#if defined(BOOST_MSVC)</a>
<a name="ln77">/*===========================================================================*/</a>
<a name="ln78">#define BOOST_BIMAP_MAP_VIEW_BASE_FRIEND(TYPE,TAG,BIMAP)                      \</a>
<a name="ln79">    typedef ::boost::bimaps::detail::map_view_base&lt;                           \</a>
<a name="ln80">        TYPE&lt;TAG,BIMAP&gt;,TAG,BIMAP &gt; friend_map_view_base;                     \</a>
<a name="ln81">    friend class friend_map_view_base;</a>
<a name="ln82">/*===========================================================================*/</a>
<a name="ln83">#else</a>
<a name="ln84">/*===========================================================================*/</a>
<a name="ln85">#define BOOST_BIMAP_MAP_VIEW_BASE_FRIEND(TYPE,TAG,BIMAP)                      \</a>
<a name="ln86">    friend class ::boost::bimaps::detail::map_view_base&lt;                      \</a>
<a name="ln87">        TYPE&lt;TAG,BIMAP&gt;,TAG,BIMAP &gt;;</a>
<a name="ln88">/*===========================================================================*/</a>
<a name="ln89">#endif</a>
<a name="ln90"> </a>
<a name="ln91"> </a>
<a name="ln92">/// \brief Common base for map views.</a>
<a name="ln93"> </a>
<a name="ln94">template&lt; class Derived, class Tag, class BimapType&gt;</a>
<a name="ln95">class map_view_base</a>
<a name="ln96">{</a>
<a name="ln97">    typedef ::boost::bimaps::container_adaptor::support::</a>
<a name="ln98">        iterator_facade_to_base&lt;</a>
<a name="ln99">            ::boost::bimaps::detail::      map_view_iterator&lt;Tag,BimapType&gt;,</a>
<a name="ln100">            ::boost::bimaps::detail::const_map_view_iterator&lt;Tag,BimapType&gt;</a>
<a name="ln101">        &gt; iterator_to_base_;</a>
<a name="ln102"> </a>
<a name="ln103">    typedef ::boost::bimaps::relation::detail::</a>
<a name="ln104">        pair_to_relation_functor&lt;Tag,</a>
<a name="ln105">            BOOST_DEDUCED_TYPENAME BimapType::relation&gt;      value_to_base_;</a>
<a name="ln106"> </a>
<a name="ln107">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln108">                           key_type_by&lt;Tag,BimapType&gt;::type       key_type_;</a>
<a name="ln109"> </a>
<a name="ln110">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln111">                          data_type_by&lt;Tag,BimapType&gt;::type      data_type_;</a>
<a name="ln112"> </a>
<a name="ln113">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln114">           pair_type_by&lt;Tag,</a>
<a name="ln115">              BOOST_DEDUCED_TYPENAME BimapType::relation&gt;::type value_type_;</a>
<a name="ln116"> </a>
<a name="ln117">    typedef </a>
<a name="ln118">        ::boost::bimaps::detail::map_view_iterator&lt;Tag,BimapType&gt; iterator_;</a>
<a name="ln119"> </a>
<a name="ln120">    public:</a>
<a name="ln121"> </a>
<a name="ln122">    bool replace(iterator_ position, const value_type_ &amp; x)</a>
<a name="ln123">    {</a>
<a name="ln124">        return derived().base().replace(</a>
<a name="ln125">            derived().template functor&lt;iterator_to_base_&gt;()(position),</a>
<a name="ln126">            derived().template functor&lt;value_to_base_&gt;()(x)</a>
<a name="ln127">        );</a>
<a name="ln128">    }</a>
<a name="ln129"> </a>
<a name="ln130">    template&lt; class CompatibleKey &gt;</a>
<a name="ln131">    bool replace_key(iterator_ position, const CompatibleKey &amp; k)</a>
<a name="ln132">    {</a>
<a name="ln133">        return derived().base().replace(</a>
<a name="ln134">            derived().template functor&lt;iterator_to_base_&gt;()(position),</a>
<a name="ln135">            derived().template functor&lt;value_to_base_&gt;()(</a>
<a name="ln136">                ::boost::bimaps::relation::detail::</a>
<a name="ln137">                    copy_with_first_replaced(*position,k)</a>
<a name="ln138">            )</a>
<a name="ln139">        );</a>
<a name="ln140">    }</a>
<a name="ln141"> </a>
<a name="ln142">    template&lt; class CompatibleData &gt;</a>
<a name="ln143">    bool replace_data(iterator_ position, const CompatibleData &amp; d)</a>
<a name="ln144">    {</a>
<a name="ln145">        return derived().base().replace(</a>
<a name="ln146">            derived().template functor&lt;iterator_to_base_&gt;()(position),</a>
<a name="ln147">            derived().template functor&lt;value_to_base_&gt;()(</a>
<a name="ln148">                ::boost::bimaps::relation::detail::</a>
<a name="ln149">                    copy_with_second_replaced(*position,d)</a>
<a name="ln150">            )</a>
<a name="ln151">        );</a>
<a name="ln152">    }</a>
<a name="ln153"> </a>
<a name="ln154">    /* This function may be provided in the future</a>
<a name="ln155"> </a>
<a name="ln156">    template&lt; class Modifier &gt;</a>
<a name="ln157">    bool modify(iterator_ position, Modifier mod)</a>
<a name="ln158">    {</a>
<a name="ln159">        return derived().base().modify(</a>
<a name="ln160"> </a>
<a name="ln161">            derived().template functor&lt;iterator_to_base_&gt;()(position),</a>
<a name="ln162"> </a>
<a name="ln163">            ::boost::bimaps::detail::relation_modifier_adaptor</a>
<a name="ln164">            &lt;</a>
<a name="ln165">                Modifier,</a>
<a name="ln166">                BOOST_DEDUCED_TYPENAME BimapType::relation,</a>
<a name="ln167">                BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln168">                data_extractor</a>
<a name="ln169">                &lt;</a>
<a name="ln170">                    Tag, BOOST_DEDUCED_TYPENAME BimapType::relation</a>
<a name="ln171"> </a>
<a name="ln172">                &gt;::type,</a>
<a name="ln173">                BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln174">                data_extractor</a>
<a name="ln175">                &lt;</a>
<a name="ln176">                    BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln177">                        opossite_tag&lt;Tag,BimapType&gt;::type,</a>
<a name="ln178">                    BOOST_DEDUCED_TYPENAME BimapType::relation</a>
<a name="ln179"> </a>
<a name="ln180">                &gt;::type</a>
<a name="ln181"> </a>
<a name="ln182">            &gt;(mod)</a>
<a name="ln183">        );</a>
<a name="ln184">    }</a>
<a name="ln185">    */</a>
<a name="ln186"> </a>
<a name="ln187">    template&lt; class Modifier &gt;</a>
<a name="ln188">    bool modify_key(iterator_ position, Modifier mod)</a>
<a name="ln189">    {</a>
<a name="ln190">        return derived().base().modify_key(</a>
<a name="ln191">            derived().template functor&lt;iterator_to_base_&gt;()(position), mod</a>
<a name="ln192">        );</a>
<a name="ln193">    }</a>
<a name="ln194"> </a>
<a name="ln195">    template&lt; class Modifier &gt;</a>
<a name="ln196">    bool modify_data(iterator_ position, Modifier mod)</a>
<a name="ln197">    {</a>
<a name="ln198">        typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln199">        data_extractor</a>
<a name="ln200">        &lt;</a>
<a name="ln201">            BOOST_DEDUCED_TYPENAME ::boost::bimaps::relation::support::</a>
<a name="ln202">                        opossite_tag&lt;Tag,BimapType&gt;::type,</a>
<a name="ln203">            BOOST_DEDUCED_TYPENAME BimapType::relation</a>
<a name="ln204"> </a>
<a name="ln205">        &gt;::type data_extractor_;</a>
<a name="ln206"> </a>
<a name="ln207">        return derived().base().modify(</a>
<a name="ln208"> </a>
<a name="ln209">            derived().template functor&lt;iterator_to_base_&gt;()(position),</a>
<a name="ln210"> </a>
<a name="ln211">            // this may be replaced later by</a>
<a name="ln212">            // ::boost::bind( mod, ::boost::bind(data_extractor_(),_1) )</a>
<a name="ln213"> </a>
<a name="ln214">            ::boost::bimaps::detail::unary_modifier_adaptor</a>
<a name="ln215">            &lt;</a>
<a name="ln216">                Modifier,</a>
<a name="ln217">                BOOST_DEDUCED_TYPENAME BimapType::relation,</a>
<a name="ln218">                data_extractor_</a>
<a name="ln219"> </a>
<a name="ln220">            &gt;(mod)</a>
<a name="ln221">        );</a>
<a name="ln222">    }</a>
<a name="ln223"> </a>
<a name="ln224">    protected:</a>
<a name="ln225"> </a>
<a name="ln226">    typedef map_view_base map_view_base_;</a>
<a name="ln227"> </a>
<a name="ln228">    private:</a>
<a name="ln229"> </a>
<a name="ln230">    // Curiously Recurring Template interface.</a>
<a name="ln231"> </a>
<a name="ln232">    Derived&amp; derived()</a>
<a name="ln233">    {</a>
<a name="ln234">        return *static_cast&lt;Derived*&gt;(this);</a>
<a name="ln235">    }</a>
<a name="ln236"> </a>
<a name="ln237">    Derived const&amp; derived() const</a>
<a name="ln238">    {</a>
<a name="ln239">        return *static_cast&lt;Derived const*&gt;(this);</a>
<a name="ln240">    }</a>
<a name="ln241">};</a>
<a name="ln242"> </a>
<a name="ln243"> </a>
<a name="ln244"> </a>
<a name="ln245"> </a>
<a name="ln246">template&lt; class Derived, class Tag, class BimapType&gt;</a>
<a name="ln247">class mutable_data_unique_map_view_access</a>
<a name="ln248">{</a>
<a name="ln249">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln250">                          data_type_by&lt;Tag,BimapType&gt;::type      data_type_;</a>
<a name="ln251"> </a>
<a name="ln252">    public:</a>
<a name="ln253"> </a>
<a name="ln254">    template&lt; class CompatibleKey &gt;</a>
<a name="ln255">    data_type_ &amp; at(const CompatibleKey&amp; k)</a>
<a name="ln256">    {</a>
<a name="ln257">        typedef ::boost::bimaps::detail::</a>
<a name="ln258">            map_view_iterator&lt;Tag,BimapType&gt; iterator;</a>
<a name="ln259"> </a>
<a name="ln260">        iterator iter = derived().find(k);</a>
<a name="ln261">        if( iter == derived().end() )</a>
<a name="ln262">        {</a>
<a name="ln263">            ::boost::throw_exception(</a>
<a name="ln264">                std::out_of_range(&quot;bimap&lt;&gt;: invalid key&quot;)</a>
<a name="ln265">            );</a>
<a name="ln266">        }</a>
<a name="ln267">        return iter-&gt;second;</a>
<a name="ln268">    }</a>
<a name="ln269"> </a>
<a name="ln270">    template&lt; class CompatibleKey &gt;</a>
<a name="ln271">    const data_type_ &amp; at(const CompatibleKey&amp; k) const</a>
<a name="ln272">    {</a>
<a name="ln273">        typedef ::boost::bimaps::detail::</a>
<a name="ln274">                const_map_view_iterator&lt;Tag,BimapType&gt; const_iterator;</a>
<a name="ln275"> </a>
<a name="ln276">        const_iterator iter = derived().find(k);</a>
<a name="ln277">        if( iter == derived().end() )</a>
<a name="ln278">        {</a>
<a name="ln279">            ::boost::throw_exception(</a>
<a name="ln280">                std::out_of_range(&quot;bimap&lt;&gt;: invalid key&quot;)</a>
<a name="ln281">            );</a>
<a name="ln282">        }</a>
<a name="ln283">        return iter-&gt;second;</a>
<a name="ln284">    }</a>
<a name="ln285"> </a>
<a name="ln286">    template&lt; class CompatibleKey &gt;</a>
<a name="ln287">    data_type_ &amp; operator[](const CompatibleKey&amp; k)</a>
<a name="ln288">    {</a>
<a name="ln289">        typedef ::boost::bimaps::detail::</a>
<a name="ln290">                      map_view_iterator&lt;Tag,BimapType&gt;          iterator;</a>
<a name="ln291"> </a>
<a name="ln292">        typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln293">                         value_type_by&lt;Tag,BimapType&gt;::type     value_type;</a>
<a name="ln294"> </a>
<a name="ln295">        iterator iter = derived().find(k);</a>
<a name="ln296">        if( iter == derived().end() )</a>
<a name="ln297">        {</a>
<a name="ln298">            iter = derived().insert( value_type(k,data_type_()) ).first;</a>
<a name="ln299">        }</a>
<a name="ln300">        return iter-&gt;second;</a>
<a name="ln301">    }</a>
<a name="ln302"> </a>
<a name="ln303">    protected:</a>
<a name="ln304"> </a>
<a name="ln305">    typedef mutable_data_unique_map_view_access</a>
<a name="ln306">                mutable_data_unique_map_view_access_;</a>
<a name="ln307"> </a>
<a name="ln308">    private:</a>
<a name="ln309"> </a>
<a name="ln310">    // Curiously Recurring Template interface.</a>
<a name="ln311"> </a>
<a name="ln312">    Derived&amp; derived()</a>
<a name="ln313">    {</a>
<a name="ln314">        return *static_cast&lt;Derived*&gt;(this);</a>
<a name="ln315">    }</a>
<a name="ln316"> </a>
<a name="ln317">    Derived const&amp; derived() const</a>
<a name="ln318">    {</a>
<a name="ln319">        return *static_cast&lt;Derived const*&gt;(this);</a>
<a name="ln320">    }</a>
<a name="ln321">};</a>
<a name="ln322"> </a>
<a name="ln323"> </a>
<a name="ln324">template&lt; class Derived, class Tag, class BimapType&gt;</a>
<a name="ln325">class non_mutable_data_unique_map_view_access</a>
<a name="ln326">{</a>
<a name="ln327">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln328">                          data_type_by&lt;Tag,BimapType&gt;::type      data_type_;</a>
<a name="ln329"> </a>
<a name="ln330">    public:</a>
<a name="ln331"> </a>
<a name="ln332">    template&lt; class CompatibleKey &gt;</a>
<a name="ln333">    const data_type_ &amp; at(const CompatibleKey&amp; k) const</a>
<a name="ln334">    {</a>
<a name="ln335">        typedef ::boost::bimaps::detail::</a>
<a name="ln336">                const_map_view_iterator&lt;Tag,BimapType&gt; const_iterator;</a>
<a name="ln337"> </a>
<a name="ln338">        const_iterator iter = derived().find(k);</a>
<a name="ln339">        if( iter == derived().end() )</a>
<a name="ln340">        {</a>
<a name="ln341">            ::boost::throw_exception(</a>
<a name="ln342">                std::out_of_range(&quot;bimap&lt;&gt;: invalid key&quot;)</a>
<a name="ln343">            );</a>
<a name="ln344">        }</a>
<a name="ln345">        return iter-&gt;second;</a>
<a name="ln346">    }</a>
<a name="ln347"> </a>
<a name="ln348">    template&lt; class CompatibleKey &gt;</a>
<a name="ln349">    data_type_ &amp; operator[](const CompatibleKey&amp;)</a>
<a name="ln350">    {</a>
<a name="ln351">        BOOST_BIMAP_STATIC_ERROR( OPERATOR_BRACKET_IS_NOT_SUPPORTED, (Derived));</a>
<a name="ln352">    }</a>
<a name="ln353"> </a>
<a name="ln354">    protected:</a>
<a name="ln355"> </a>
<a name="ln356">    typedef non_mutable_data_unique_map_view_access</a>
<a name="ln357">                non_mutable_data_unique_map_view_access_;</a>
<a name="ln358"> </a>
<a name="ln359">    private:</a>
<a name="ln360"> </a>
<a name="ln361">    // Curiously Recurring Template interface.</a>
<a name="ln362"> </a>
<a name="ln363">    Derived&amp; derived()</a>
<a name="ln364">    {</a>
<a name="ln365">        return *static_cast&lt;Derived*&gt;(this);</a>
<a name="ln366">    }</a>
<a name="ln367"> </a>
<a name="ln368">    Derived const&amp; derived() const</a>
<a name="ln369">    {</a>
<a name="ln370">        return *static_cast&lt;Derived const*&gt;(this);</a>
<a name="ln371">    }</a>
<a name="ln372">};</a>
<a name="ln373"> </a>
<a name="ln374"> </a>
<a name="ln375">template&lt; class Derived, class Tag, class BimapType&gt;</a>
<a name="ln376">struct unique_map_view_access</a>
<a name="ln377">{</a>
<a name="ln378">    private:</a>
<a name="ln379">    typedef BOOST_DEDUCED_TYPENAME ::boost::bimaps::support::</a>
<a name="ln380">        value_type_by&lt;Tag,BimapType&gt;::type value_type;</a>
<a name="ln381"> </a>
<a name="ln382">    public:</a>
<a name="ln383">    typedef BOOST_DEDUCED_TYPENAME ::boost::mpl::if_</a>
<a name="ln384">    &lt;</a>
<a name="ln385">        typename ::boost::is_const&lt;</a>
<a name="ln386">            BOOST_DEDUCED_TYPENAME value_type::second_type &gt;::type,</a>
<a name="ln387"> </a>
<a name="ln388">        non_mutable_data_unique_map_view_access&lt;Derived,Tag,BimapType&gt;,</a>
<a name="ln389">        mutable_data_unique_map_view_access&lt;Derived,Tag,BimapType&gt;</a>
<a name="ln390"> </a>
<a name="ln391">    &gt;::type type;</a>
<a name="ln392">};</a>
<a name="ln393"> </a>
<a name="ln394">// Map views specialize the following structs to provide to the bimap class</a>
<a name="ln395">// the extra side typedefs (i.e. left_local_iterator for unordered_maps, </a>
<a name="ln396">// right_range_type for maps)</a>
<a name="ln397"> </a>
<a name="ln398">template&lt; class MapView &gt;</a>
<a name="ln399">struct  left_map_view_extra_typedefs {};</a>
<a name="ln400"> </a>
<a name="ln401">template&lt; class MapView &gt;</a>
<a name="ln402">struct right_map_view_extra_typedefs {};</a>
<a name="ln403"> </a>
<a name="ln404">} // namespace detail</a>
<a name="ln405"> </a>
<a name="ln406">// This function is already part of Boost.Lambda.</a>
<a name="ln407">// They may be moved to Boost.Utility.</a>
<a name="ln408"> </a>
<a name="ln409">template &lt;class T&gt; inline const T&amp;  make_const(const T&amp; t) { return t; }</a>
<a name="ln410"> </a>
<a name="ln411">} // namespace bimaps</a>
<a name="ln412">} // namespace boost</a>
<a name="ln413"> </a>
<a name="ln414"> </a>
<a name="ln415">// The following macros avoids code duplication in map views</a>
<a name="ln416">// Maybe this can be changed in the future using a scheme similar to</a>
<a name="ln417">// the one used with map_view_base.</a>
<a name="ln418"> </a>
<a name="ln419">/*===========================================================================*/</a>
<a name="ln420">#define BOOST_BIMAP_MAP_VIEW_RANGE_IMPLEMENTATION(BASE)                       \</a>
<a name="ln421">                                                                              \</a>
<a name="ln422">typedef std::pair&lt;                                                            \</a>
<a name="ln423">    BOOST_DEDUCED_TYPENAME base_::iterator,                                   \</a>
<a name="ln424">    BOOST_DEDUCED_TYPENAME base_::iterator&gt; range_type;                       \</a>
<a name="ln425">                                                                              \</a>
<a name="ln426">typedef std::pair&lt;                                                            \</a>
<a name="ln427">    BOOST_DEDUCED_TYPENAME base_::const_iterator,                             \</a>
<a name="ln428">    BOOST_DEDUCED_TYPENAME base_::const_iterator&gt; const_range_type;           \</a>
<a name="ln429">                                                                              \</a>
<a name="ln430">                                                                              \</a>
<a name="ln431">template&lt; class LowerBounder, class UpperBounder&gt;                             \</a>
<a name="ln432">range_type range(LowerBounder lower,UpperBounder upper)                       \</a>
<a name="ln433">{                                                                             \</a>
<a name="ln434">    std::pair&lt;                                                                \</a>
<a name="ln435">                                                                              \</a>
<a name="ln436">        BOOST_DEDUCED_TYPENAME BASE::base_type::iterator,                     \</a>
<a name="ln437">        BOOST_DEDUCED_TYPENAME BASE::base_type::iterator                      \</a>
<a name="ln438">                                                                              \</a>
<a name="ln439">    &gt; r( this-&gt;base().range(lower,upper) );                                   \</a>
<a name="ln440">                                                                              \</a>
<a name="ln441">    return range_type(                                                        \</a>
<a name="ln442">        this-&gt;template functor&lt;                                               \</a>
<a name="ln443">            BOOST_DEDUCED_TYPENAME BASE::iterator_from_base                   \</a>
<a name="ln444">        &gt;()                                         ( r.first ),              \</a>
<a name="ln445">        this-&gt;template functor&lt;                                               \</a>
<a name="ln446">            BOOST_DEDUCED_TYPENAME BASE::iterator_from_base                   \</a>
<a name="ln447">        &gt;()                                         ( r.second )              \</a>
<a name="ln448">    );                                                                        \</a>
<a name="ln449">}                                                                             \</a>
<a name="ln450">                                                                              \</a>
<a name="ln451">template&lt; class LowerBounder, class UpperBounder&gt;                             \</a>
<a name="ln452">const_range_type range(LowerBounder lower,UpperBounder upper) const           \</a>
<a name="ln453">{                                                                             \</a>
<a name="ln454">    std::pair&lt;                                                                \</a>
<a name="ln455">                                                                              \</a>
<a name="ln456">        BOOST_DEDUCED_TYPENAME BASE::base_type::const_iterator,               \</a>
<a name="ln457">        BOOST_DEDUCED_TYPENAME BASE::base_type::const_iterator                \</a>
<a name="ln458">                                                                              \</a>
<a name="ln459">    &gt; r( this-&gt;base().range(lower,upper) );                                   \</a>
<a name="ln460">                                                                              \</a>
<a name="ln461">    return const_range_type(                                                  \</a>
<a name="ln462">        this-&gt;template functor&lt;                                               \</a>
<a name="ln463">            BOOST_DEDUCED_TYPENAME BASE::iterator_from_base                   \</a>
<a name="ln464">        &gt;()                                         ( r.first ),              \</a>
<a name="ln465">        this-&gt;template functor&lt;                                               \</a>
<a name="ln466">            BOOST_DEDUCED_TYPENAME BASE::iterator_from_base                   \</a>
<a name="ln467">        &gt;()                                         ( r.second )              \</a>
<a name="ln468">    );                                                                        \</a>
<a name="ln469">}</a>
<a name="ln470">/*===========================================================================*/</a>
<a name="ln471"> </a>
<a name="ln472"> </a>
<a name="ln473">/*===========================================================================*/</a>
<a name="ln474">#define BOOST_BIMAP_VIEW_ASSIGN_IMPLEMENTATION(BASE)                          \</a>
<a name="ln475">                                                                              \</a>
<a name="ln476">template&lt; class InputIterator &gt;                                               \</a>
<a name="ln477">void assign(InputIterator first,InputIterator last)                           \</a>
<a name="ln478">{                                                                             \</a>
<a name="ln479">    this-&gt;clear();                                                            \</a>
<a name="ln480">    this-&gt;insert(this-&gt;end(),first,last);                                     \</a>
<a name="ln481">}                                                                             \</a>
<a name="ln482">                                                                              \</a>
<a name="ln483">void assign(BOOST_DEDUCED_TYPENAME BASE::size_type n,                         \</a>
<a name="ln484">            const BOOST_DEDUCED_TYPENAME BASE::value_type&amp; v)                 \</a>
<a name="ln485">{                                                                             \</a>
<a name="ln486">    this-&gt;clear();                                                            \</a>
<a name="ln487">    for(BOOST_DEDUCED_TYPENAME BASE::size_type i = 0 ; i &lt; n ; ++i)           \</a>
<a name="ln488">    {                                                                         \</a>
<a name="ln489">        this-&gt;push_back(v);                                                   \</a>
<a name="ln490">    }                                                                         \</a>
<a name="ln491">}</a>
<a name="ln492">/*===========================================================================*/</a>
<a name="ln493"> </a>
<a name="ln494"> </a>
<a name="ln495">/*===========================================================================*/</a>
<a name="ln496">#define BOOST_BIMAP_VIEW_FRONT_BACK_IMPLEMENTATION(BASE)                      \</a>
<a name="ln497">                                                                              \</a>
<a name="ln498">BOOST_DEDUCED_TYPENAME BASE::reference front()                                \</a>
<a name="ln499">{                                                                             \</a>
<a name="ln500">    return this-&gt;template functor&lt;                                            \</a>
<a name="ln501">        BOOST_DEDUCED_TYPENAME base_::value_from_base&gt;()                      \</a>
<a name="ln502">    (                                                                         \</a>
<a name="ln503">        const_cast                                                            \</a>
<a name="ln504">        &lt;                                                                     \</a>
<a name="ln505">            BOOST_DEDUCED_TYPENAME BASE::base_type::value_type &amp;              \</a>
<a name="ln506">                                                                              \</a>
<a name="ln507">        &gt; ( this-&gt;base().front() )                                            \</a>
<a name="ln508">    );                                                                        \</a>
<a name="ln509">}                                                                             \</a>
<a name="ln510">                                                                              \</a>
<a name="ln511">BOOST_DEDUCED_TYPENAME BASE::reference back()                                 \</a>
<a name="ln512">{                                                                             \</a>
<a name="ln513">    return this-&gt;template functor&lt;                                            \</a>
<a name="ln514">        BOOST_DEDUCED_TYPENAME base_::value_from_base&gt;()                      \</a>
<a name="ln515">    (                                                                         \</a>
<a name="ln516">        const_cast                                                            \</a>
<a name="ln517">        &lt;                                                                     \</a>
<a name="ln518">            BOOST_DEDUCED_TYPENAME BASE::base_type::value_type &amp;              \</a>
<a name="ln519">                                                                              \</a>
<a name="ln520">        &gt;( this-&gt;base().back() )                                              \</a>
<a name="ln521">    );                                                                        \</a>
<a name="ln522">}                                                                             \</a>
<a name="ln523">                                                                              \</a>
<a name="ln524">BOOST_DEDUCED_TYPENAME BASE::const_reference front() const                    \</a>
<a name="ln525">{                                                                             \</a>
<a name="ln526">    return this-&gt;template functor&lt;                                            \</a>
<a name="ln527">        BOOST_DEDUCED_TYPENAME BASE::value_from_base&gt;()                       \</a>
<a name="ln528">    (                                                                         \</a>
<a name="ln529">        this-&gt;base().front()                                                  \</a>
<a name="ln530">    );                                                                        \</a>
<a name="ln531">}                                                                             \</a>
<a name="ln532">                                                                              \</a>
<a name="ln533">BOOST_DEDUCED_TYPENAME BASE::const_reference back() const                     \</a>
<a name="ln534">{                                                                             \</a>
<a name="ln535">    return this-&gt;template functor&lt;                                            \</a>
<a name="ln536">        BOOST_DEDUCED_TYPENAME BASE::value_from_base&gt;()                       \</a>
<a name="ln537">    (                                                                         \</a>
<a name="ln538">        this-&gt;base().back()                                                   \</a>
<a name="ln539">    );                                                                        \</a>
<a name="ln540">}</a>
<a name="ln541">/*===========================================================================*/</a>
<a name="ln542"> </a>
<a name="ln543"> </a>
<a name="ln544">#endif // BOOST_BIMAP_DETAIL_MAP_VIEW_BASE_HPP</a>

</code></pre>
<div class="balloon" rel="352"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v591/" target="_blank">V591</a> Non-void function should return a value.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
